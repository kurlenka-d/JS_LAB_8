<!DOCTYPE html>
<html>

<head>
    <title>Свойства объекта Document</title>
    <style>
        body {
            background-color: #ffffff;
            text-decoration-color: #800080;
        }

        .letter {
            color: #000000;
        }

        a {
            color: #0000ff;
        }

        a :visited {
            color: #800080;
        }
    </style>
</head>
<script language="javascript">
    function rgbToHex(color) {
        color = "" + color;
        if (!color || color.indexOf("rgb") < 0) {
            return;
        }

        if (color.charAt(0) == "#") {
            return color;
        }

        var nums = /(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(color),
            r = parseInt(nums[2], 10).toString(16),
            g = parseInt(nums[3], 10).toString(16),
            b = parseInt(nums[4], 10).toString(16);

        return "#" + (
            (r.length == 1 ? "0" + r : r) +
            (g.length == 1 ? "0" + g : g) +
            (b.length == 1 ? "0" + b : b)
        );
    }

    function func() {
        var body = document.getElementsByTagName('body')[0];
        var a = document.createElement('a');
        body.appendChild(a);
        a.style.display = 'none';

        var bgc = window.getComputedStyle(body, null).getPropertyValue("background-color");
        var fgc = window.getComputedStyle(body, '.letter').getPropertyValue("color");
        var lc = window.getComputedStyle(a, null).getPropertyValue("color");
        var al = window.getComputedStyle(a, null).getPropertyValue("color");
        var vlc = window.getComputedStyle(body, null).getPropertyValue("text-decoration-color");

        var url = document.location;
        var ref = document.referrer;
        var t = document.getElementsByTagName('title')[0].innerHTML;
        var lm = document.lastModified;
        document.write("Цвет фона этой страницы <B>" + rgbToHex(bgc) + "</B>.");
        document.write("<br>Цвет текста этой страницы <B>" + rgbToHex(fgc) + "</b>.");
        document.write("<br>Цвет ссылок этой страницы <b>" + rgbToHex(lc) + "</b>.");
        document.write("<br>Цвет активной ссылки этой страницы <B>" + rgbToHex(al) + "</b>.");
        document.write("<br>Цвет посещенной ссылки этой страницы <B>" + rgbToHex(vlc) + "</b>.");
        document.write("<br>URL этой страницы <B>" + url + "</b>.");
        document.write("<br>До этого вы были на странице <B>" + ref + "</b>.");
        document.write("<br>Заголовок этой страницы <B>" + t + "</b>.");
        document.write("<br>Последние изменения в документ внесены: <b>" + lm + "</b>");
    }
</script>

<body>
    <button onClick="func()">Кнопка</button>
</body>

</html>